<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page 1</title>
    <link rel="stylesheet" href="../css_style/profile.css"> <!-- Подключение стилей -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="name-cont">
        <div class="name-row">
            <img src="../icons/101Roze/2-jpg (1).jpg" class="circle-image">
            <div class="user-inf-col">
                <div class="name-text" id="username"></div>
                <span class="profile-link" id="openProfileBtn">Показать профиль</span>
                <div class="bonus-text">5.0 | 1 отзыв</div>
                <div class="bonus-row">
                    <div class="my-bonus-text">Мои бонусы</div>
                    <div class="bonus-container">
                        <div class="bonus-box">                <!-- Фиолетовый контейнер -->
                            <img src="../icons/ruble.png" class="bonus-icon">
                            <span class="bonus-value">0</span> <!-- Значение бонусов -->
                        </div>
                    </div>
            
                </div>

            </div>
        </div>
    </div>
    <div class="name-cont">
        <div class="user-inf-col">
            <div class="text-two-container">Настройка уведомлений</div>
            <hr style="border: 1px solid rgb(162, 153, 153); width: 90%; margin: 20px auto;">
            <div class="text-two-container-t">Правовые докуметы</div>
            <hr style="border: 1px solid rgb(146, 141, 141); width: 90%; margin: 20px auto;">
        </div>
    
    </div>
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <div class="window-row-up">
                <h2>User profile</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="input-col">
                <label for="name">ФИО</label>
                <input type="text" id="name" name="name" placeholder="ФИО" >
                <label for="name">Телефон</label>
                <input type="text" id="name" name="name" placeholder="Телефон" >
                <label for="name">E-mail</label>
                <input type="text" id="name" name="name" placeholder="E-mail" >
                <label for="name">Дата рождения</label>
                <input type="text" id="name" name="name" placeholder="Дата рождения" >
                <div class="save-button">
                    Сохранить
                </div>
        
            </div>
            

        </div>
        
    </div>
    <div class="refferal-code-text">Your refferal code</div>
    <div class="copy-container">
        <!-- Поле для показа реферального кода -->
        <span id="referralCode" class="referral-code">REF123456</span>
        
        <!-- Кнопка для копирования -->
        <button class="copy-button" onclick="copyReferralCode()">Copy</button>
        
        <!-- Сообщение об успешном копировании -->
        <span id="copySuccess" class="copy-success">Code has copied</span>
    </div>

    <script>
        // Функция для копирования реферального кода
        function copyReferralCode() {
            // Получаем элемент с реферальным кодом
            var referralCode = document.getElementById("referralCode").innerText;
            
            // Создаем временный элемент input для копирования текста
            var tempInput = document.createElement("input");
            tempInput.value = referralCode;
            document.body.appendChild(tempInput);
            
            // Выделяем текст и копируем его в буфер обмена
            tempInput.select();
            document.execCommand("copy");
            
            // Удаляем временный элемент
            document.body.removeChild(tempInput);

            // Показываем сообщение об успешном копировании
            var copySuccess = document.getElementById("copySuccess");
            copySuccess.style.display = "inline";
            
            // Прячем сообщение через 2 секунды
            setTimeout(function() {
                copySuccess.style.display = "none";
            }, 2000);
        }
    </script>

    <script>
        // Получаем элементы
        var modal = document.getElementById("profileModal");
        var openBtn = document.getElementById("openProfileBtn");
        var closeBtn = document.getElementsByClassName("close-btn")[0];
        
        // Открыть модальное окно при нажатии на "Показать профиль"
        openBtn.onclick = function() {
            modal.style.display = "block";
        }
        
        // Закрыть модальное окно при нажатии на кнопку "x"
        closeBtn.onclick = function() {
            modal.style.display = "none";
        }
        
        // Закрыть модальное окно, если пользователь нажал за его пределами
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }
        </script>
       
       <script>
    // Инициализация Web App

    let WebApp = window.Telegram.WebApp;
    console.log(WebApp.initDataUnsafe);

    // Получаем параметры из initData
    const params = new URLSearchParams(window.Telegram.WebApp.initData);

    // Преобразуем параметры в объект
    const userData = Object.fromEntries(params);


    // Преобразуем данные пользователя из строки в объект
    if (userData.user) {
        userData.user = JSON.parse(userData.user);

        // Проверяем наличие данных о пользователе и вставляем их в HTML
        let username = document.getElementById("username");
        let p = document.createElement("p");

        // Вставляем first_name и last_name или username
        p.innerText = `${userData.user.first_name || ''} ${userData.user.last_name || ''}`.trim() || userData.user.username;
        username.appendChild(p);
    } else {
        // Если данных о пользователе нет, отображаем сообщение
        document.getElementById("username").textContent = "Неизвестный пользователь";
    }
</script>

    
    <div class="bottom-menu">
        <a href="clicker.html"><img src="../icons/house.png" class="menu-icon" alt="Home"></a>
        <a href="tasks.html"><img src="../icons/tasks-icon.webp" class="tasks-icon" alt="Tasks"></a>
        <a href="../index.html"><img src="../icons/shop.png" class="menu-icon-cart" alt="Shop"></a>
        <a href="cart.html"><img src="../icons/empty-cart.png" class="menu-icon" alt="Cart"></a>
        <a href="orders.html"><img src="../icons/task.png" class="menu-icon" alt="Orders"></a>
        <a href="profile.html"><img src="../icons/user.png" class="menu-icon" alt="Profile"></a>
    </div>

</body>
</html>
